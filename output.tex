-------- Discrete diffusion matrix ---------- \\
Matrix (1, 1) :
\begin{dmath}
\frac{2 \tau \tilde{s}_\phi^{2}}{9} + \frac{\tau \tilde{s}_\phi u_{1} |J|^{-1}}{3} - \tau u_{1}^{2} \left(|J|^{-1}\right)^{2} - \tilde{\nu}_\phi \left(|J|^{-1}\right)^{2} + \frac{2 \tilde{s}_\phi}{9} + \max\left(\frac{u_{1} |J|^{-1}}{3}, \frac{u_{2} |J|^{-1}}{3}\right) + \max\left(\frac{u_{1} |J|^{-1}}{3}, - \frac{|J|^{-1} \left(u_{1} + u_{2}\right)}{3}\right)
\end{dmath}
Matrix (1, 2) :
\begin{dmath}
- \frac{\tau \left(\tilde{s}_\phi + 3 u_{1} |J|^{-1}\right) \left(\tilde{s}_\phi + 3 u_{2} |J|^{-1}\right)}{9} - \frac{\tilde{s}_\phi}{9} - \max\left(\frac{u_{1} |J|^{-1}}{3}, \frac{u_{2} |J|^{-1}}{3}\right)
\end{dmath}
Matrix (1, 3) :
\begin{dmath}
\frac{\tau \left(\tilde{s}_\phi + 3 u_{1} |J|^{-1}\right) \left(- \tilde{s}_\phi + 3 u_{1} |J|^{-1} + 3 u_{2} |J|^{-1}\right)}{9} + \tilde{\nu}_\phi \left(|J|^{-1}\right)^{2} - \frac{\tilde{s}_\phi}{9} - \max\left(\frac{u_{1} |J|^{-1}}{3}, - \frac{|J|^{-1} \left(u_{1} + u_{2}\right)}{3}\right)
\end{dmath}
Matrix (2, 1) :
\begin{dmath}
- \frac{\tau \left(\tilde{s}_\phi + 3 u_{1} |J|^{-1}\right) \left(\tilde{s}_\phi + 3 u_{2} |J|^{-1}\right)}{9} - \frac{\tilde{s}_\phi}{9} - \max\left(\frac{u_{1} |J|^{-1}}{3}, \frac{u_{2} |J|^{-1}}{3}\right)
\end{dmath}
Matrix (2, 2) :
\begin{dmath}
\frac{2 \tau \tilde{s}_\phi^{2}}{9} + \frac{\tau \tilde{s}_\phi u_{2} |J|^{-1}}{3} - \tau u_{2}^{2} \left(|J|^{-1}\right)^{2} - \tilde{\nu}_\phi \left(|J|^{-1}\right)^{2} + \frac{2 \tilde{s}_\phi}{9} + \max\left(\frac{u_{1} |J|^{-1}}{3}, \frac{u_{2} |J|^{-1}}{3}\right) + \max\left(\frac{u_{2} |J|^{-1}}{3}, - \frac{|J|^{-1} \left(u_{1} + u_{2}\right)}{3}\right)
\end{dmath}
Matrix (2, 3) :
\begin{dmath}
\frac{\tau \left(\tilde{s}_\phi + 3 u_{2} |J|^{-1}\right) \left(- \tilde{s}_\phi + 3 u_{1} |J|^{-1} + 3 u_{2} |J|^{-1}\right)}{9} + \tilde{\nu}_\phi \left(|J|^{-1}\right)^{2} - \frac{\tilde{s}_\phi}{9} - \max\left(\frac{u_{2} |J|^{-1}}{3}, - \frac{|J|^{-1} \left(u_{1} + u_{2}\right)}{3}\right)
\end{dmath}
Matrix (3, 1) :
\begin{dmath}
\frac{\tau \left(\tilde{s}_\phi + 3 u_{1} |J|^{-1}\right) \left(- \tilde{s}_\phi + 3 u_{1} |J|^{-1} + 3 u_{2} |J|^{-1}\right)}{9} + \tilde{\nu}_\phi \left(|J|^{-1}\right)^{2} - \frac{\tilde{s}_\phi}{9} - \max\left(\frac{u_{1} |J|^{-1}}{3}, - \frac{|J|^{-1} \left(u_{1} + u_{2}\right)}{3}\right)
\end{dmath}
Matrix (3, 2) :
\begin{dmath}
\frac{\tau \left(\tilde{s}_\phi + 3 u_{2} |J|^{-1}\right) \left(- \tilde{s}_\phi + 3 u_{1} |J|^{-1} + 3 u_{2} |J|^{-1}\right)}{9} + \tilde{\nu}_\phi \left(|J|^{-1}\right)^{2} - \frac{\tilde{s}_\phi}{9} - \max\left(\frac{u_{2} |J|^{-1}}{3}, - \frac{|J|^{-1} \left(u_{1} + u_{2}\right)}{3}\right)
\end{dmath}
Matrix (3, 3) :
\begin{dmath}
- \frac{\tau \left(\tilde{s}_\phi + 3 u_{1} |J|^{-1}\right) \left(- \tilde{s}_\phi + 3 u_{1} |J|^{-1} + 3 u_{2} |J|^{-1}\right)}{9} - \frac{\tau \left(\tilde{s}_\phi + 3 u_{2} |J|^{-1}\right) \left(- \tilde{s}_\phi + 3 u_{1} |J|^{-1} + 3 u_{2} |J|^{-1}\right)}{9} - 2 \tilde{\nu}_\phi \left(|J|^{-1}\right)^{2} + \frac{2 \tilde{s}_\phi}{9} + \max\left(\frac{u_{1} |J|^{-1}}{3}, - \frac{|J|^{-1} \left(u_{1} + u_{2}\right)}{3}\right) + \max\left(\frac{u_{2} |J|^{-1}}{3}, - \frac{|J|^{-1} \left(u_{1} + u_{2}\right)}{3}\right)
\end{dmath}
-------- stream line diffusion matrix ---------- \\
Matrix (1, 1) :
\begin{dmath}
\frac{k_{s} u_{1}^{2} \left(|J|^{-1}\right)^{2}}{|\underline{u}|^{2}}
\end{dmath}
Matrix (1, 2) :
\begin{dmath}
\frac{k_{s} u_{1} u_{2} \left(|J|^{-1}\right)^{2}}{|\underline{u}|^{2}}
\end{dmath}
Matrix (1, 3) :
\begin{dmath}
- \frac{k_{s} u_{1} \left(|J|^{-1}\right)^{2} \left(u_{1} + u_{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 1) :
\begin{dmath}
\frac{k_{s} u_{1} u_{2} \left(|J|^{-1}\right)^{2}}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 2) :
\begin{dmath}
\frac{k_{s} u_{2}^{2} \left(|J|^{-1}\right)^{2}}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 3) :
\begin{dmath}
- \frac{k_{s} u_{2} \left(|J|^{-1}\right)^{2} \left(u_{1} + u_{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 1) :
\begin{dmath}
- \frac{k_{s} u_{1} \left(|J|^{-1}\right)^{2} \left(u_{1} + u_{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 2) :
\begin{dmath}
- \frac{k_{s} u_{2} \left(|J|^{-1}\right)^{2} \left(u_{1} + u_{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 3) :
\begin{dmath}
\frac{k_{s} \left(|J|^{-1}\right)^{2} \left(u_{1} + u_{2}\right)^{2}}{|\underline{u}|^{2}}
\end{dmath}
-------- cross wind diffusion matrix ---------- \\
Matrix (1, 1) :
\begin{dmath}
- \frac{k_{c} \left(|J|^{-1}\right)^{2} \left(u_{1}^{2} - |\underline{u}|^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (1, 2) :
\begin{dmath}
- \frac{k_{c} u_{1} u_{2} \left(|J|^{-1}\right)^{2}}{|\underline{u}|^{2}}
\end{dmath}
Matrix (1, 3) :
\begin{dmath}
\frac{k_{c} \left(|J|^{-1}\right)^{2} \left(u_{1} \left(u_{1} + u_{2}\right) - |\underline{u}|^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 1) :
\begin{dmath}
- \frac{k_{c} u_{1} u_{2} \left(|J|^{-1}\right)^{2}}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 2) :
\begin{dmath}
- \frac{k_{c} \left(|J|^{-1}\right)^{2} \left(u_{2}^{2} - |\underline{u}|^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 3) :
\begin{dmath}
\frac{k_{c} \left(|J|^{-1}\right)^{2} \left(u_{2} \left(u_{1} + u_{2}\right) - |\underline{u}|^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 1) :
\begin{dmath}
\frac{k_{c} \left(|J|^{-1}\right)^{2} \left(u_{1} \left(u_{1} + u_{2}\right) - |\underline{u}|^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 2) :
\begin{dmath}
\frac{k_{c} \left(|J|^{-1}\right)^{2} \left(u_{2} \left(u_{1} + u_{2}\right) - |\underline{u}|^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 3) :
\begin{dmath}
\frac{k_{c} \left(|J|^{-1}\right)^{2} \left(2 |\underline{u}|^{2} - \left(u_{1} + u_{2}\right)^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
-------- total diffusion matrix ---------- \\
Matrix (1, 1) :
\begin{dmath}
\frac{\left(|J|^{-1}\right)^{2} \left(- k_{c} \left(u_{1}^{2} - |\underline{u}|^{2}\right) + k_{s} u_{1}^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (1, 2) :
\begin{dmath}
\frac{u_{1} u_{2} \left(|J|^{-1}\right)^{2} \left(- k_{c} + k_{s}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (1, 3) :
\begin{dmath}
\frac{\left(|J|^{-1}\right)^{2} \left(k_{c} \left(u_{1} \left(u_{1} + u_{2}\right) - |\underline{u}|^{2}\right) - k_{s} u_{1} \left(u_{1} + u_{2}\right)\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 1) :
\begin{dmath}
\frac{u_{1} u_{2} \left(|J|^{-1}\right)^{2} \left(- k_{c} + k_{s}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 2) :
\begin{dmath}
\frac{\left(|J|^{-1}\right)^{2} \left(- k_{c} \left(u_{2}^{2} - |\underline{u}|^{2}\right) + k_{s} u_{2}^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (2, 3) :
\begin{dmath}
\frac{\left(|J|^{-1}\right)^{2} \left(k_{c} \left(u_{2} \left(u_{1} + u_{2}\right) - |\underline{u}|^{2}\right) - k_{s} u_{2} \left(u_{1} + u_{2}\right)\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 1) :
\begin{dmath}
\frac{\left(|J|^{-1}\right)^{2} \left(k_{c} \left(u_{1} \left(u_{1} + u_{2}\right) - |\underline{u}|^{2}\right) - k_{s} u_{1} \left(u_{1} + u_{2}\right)\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 2) :
\begin{dmath}
\frac{\left(|J|^{-1}\right)^{2} \left(k_{c} \left(u_{2} \left(u_{1} + u_{2}\right) - |\underline{u}|^{2}\right) - k_{s} u_{2} \left(u_{1} + u_{2}\right)\right)}{|\underline{u}|^{2}}
\end{dmath}
Matrix (3, 3) :
\begin{dmath}
\frac{\left(|J|^{-1}\right)^{2} \left(k_{c} \left(2 |\underline{u}|^{2} - \left(u_{1} + u_{2}\right)^{2}\right) + k_{s} \left(u_{1} + u_{2}\right)^{2}\right)}{|\underline{u}|^{2}}
\end{dmath}
-------- cross wind row sum ---------- \\
Vector (1) :
\begin{dmath}
0
\end{dmath}
Vector (2) :
\begin{dmath}
0
\end{dmath}
Vector (3) :
\begin{dmath}
0
\end{dmath}
-------- stream line row sum ---------- \\
Vector (1) :
\begin{dmath}
0
\end{dmath}
Vector (2) :
\begin{dmath}
0
\end{dmath}
Vector (3) :
\begin{dmath}
0
\end{dmath}
